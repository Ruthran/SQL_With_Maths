CREATE TABLE CITY_DIST(SOURCE VARCHAR(35), TARGET VARCHAR(35), DIST NUMBER(5));
INSERT INTO CITY_DIST VALUES ('MAD', 'HYD', 800);

SELECT * FROM CITY_DIST AS A INNER JOIN CITY_DIST AS B
ON A.SOURCE = B.TARGET AND A.TARGET = B.SOURCE;


SELECT SOURCE,
ABS(HASH(SOURCE)) AS SOURCEID
FROM CITY_DIST;

SELECT SOURCE, TARGET, DIST FROM 
(
    SELECT SOURCE, TARGET, DIST,
    ROW_NUMBER() OVER (PARTITION BY (SOURCEID + TARGETID) + (SOURCEID * TARGETID) ORDER BY SOURCEID) RN
    FROM (SELECT SOURCE, ABS(HASH(SOURCE)) AS SOURCEID, TARGET, ABS(HASH(TARGET)) AS TARGETID, DIST FROM CITY_DIST)
) WHERE RN = 1;

/*Swapping the same in same order and group by to eliminate duplicates*/
SELECT SOURCE, TARGET, DIST FROM
(
SELECT DIST,
CASE WHEN SOURCE > TARGET THEN SOURCE ELSE TARGET END AS SOURCE,
CASE WHEN SOURCE < TARGET THEN SOURCE ELSE TARGET END AS TARGET,
FROM CITY_DIST
) GROUP BY SOURCE, TARGET, DIST;
