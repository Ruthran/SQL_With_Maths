CREATE TABLE CITY_DIST(SOURCE VARCHAR(35), TARGET VARCHAR(35), DIST NUMBER(5));
INSERT INTO CITY_DIST VALUES ('MAD', 'HYD', 800);

SELECT * FROM CITY_DIST AS A INNER JOIN CITY_DIST AS B
ON A.SOURCE = B.TARGET AND A.TARGET = B.SOURCE;


SELECT SOURCE,
ABS(HASH(SOURCE)) AS SOURCEID
FROM CITY_DIST;

SELECT SOURCEID, TARGETID FROM 
(
    SELECT SOURCEID, TARGETID,
    ROW_NUMBER() OVER (PARTITION BY (SOURCEID + TARGETID) + (SOURCEID * TARGETID) ORDER BY SOURCEID) RN
    FROM (SELECT ABS(HASH(SOURCE)) AS SOURCEID, ABS(HASH(TARGET)) AS TARGETID,  FROM CITY_DIST)
) WHERE RN = 1;
